<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link href="https://fonts.googleapis.com/css?family=Cabin+Sketch" rel="stylesheet">
    <style>
      body{font-family: 'Cabin Sketch', cursive;}
    </style>
    <meta charset="utf-8">
    <title>Clay Club Mailing List</title>
    <link rel = "shortcut icon" type = "image/png" href = "/favicon.png">
    <link rel="stylesheet" href="/materialize.css">
    <link rel="stylesheet" href="/animate.css">
    <script type="text/javascript" src="/jquery.js"></script>

  </head>
  <body>
    <script type="text/javascript" src="/materialize.js"></script>
    <div class = "header" style = "
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;">
      <img id="logo"src="/porcelain.png" class="animated bounceInDown"style="height:150px;">
      <p style = "font-size: 300%;">UPS Clay Club Mailing List</p>
    </div>
    <!--to subscribe div-->
    <div class="to_sub"  style="
    display: flex;
     align-items: center;
     justify-content: center;
     font-size: 250%;
     ">
      <p>to subscribe:</p>
      <form class="" onsubmit="return to_sub();" method="">
        <input id="sub_form" type="text" value="" style="
        margin-left: 15px;
        padding: 6px;">
      </form>
    </div>
    <!--to unsubscribe div-->
    <div class="to_unsub"  style="
    display: flex;
     align-items: center;
     justify-content: center;
     font-size: 250%;">
      <p>to unsubscribe:</p>
      <form class="" onsubmit="return to_sub();" method="">
        <input id="unsub_form" type="text" value="" style="
        margin-left: 15px;
        padding: 6px;">
      </form>
    </div>
    <!--facebook div-->
    <div class="facebook" style="
    display: flex;
    text-align:center;
     align-items: center;
     justify-content: center;
     font-size:250%;
     width:50%;
     ">
      <p>Check out our <a href="https://www.facebook.com/upsclay/?ref=br_rs" target="_blank">Facebook Page</a> @upsclay for event information and direct messaging!</p>
    </div>
    <script type="text/javascript">
    function to_sub(){
      let logo = document.getElementById('logo')
      let remove = document.getElementById("unsub_form")
      let add = document.getElementById("sub_form")

      if (add.value) {
        if (!add.value.includes("@pugetsound.edu")) {
          console.log('need puget sound addr')
          Materialize.toast('error : @pugetsound.edu')
          var toastElement =  document.querySelector('.toast')
          setTimeout(function() {
            for (x in Materialize.Toast._toasts) {
              Materialize.Toast._toasts[x].remove()
            }
          }, 4000)

        } else  {
          logo.classList.remove("animated")
          logo.classList.remove("bounceInDown")
          setTimeout(function() {
            logo.classList.add("animated")
            logo.classList.add("bounce")
          }, 500)
          setTimeout(function() {
            logo.classList.remove("animated")
            logo.classList.remove("bounce")
          }, 2500)
          Materialize.toast('subscribe ' + add.value)
          var toastElement =  document.querySelector('.toast')
          setTimeout(function() {
            for (x in Materialize.Toast._toasts) {
              Materialize.Toast._toasts[x].remove()
            }
          }, 4000)

          var xhr = new XMLHttpRequest()
          xhr.open("POST", '/sub', true)
          xhr.setRequestHeader('Content-Type', 'application/json')
          xhr.send(JSON.stringify({
            data : add.value
          }))
          add.value = ''
        }
      } else if (remove.value) {
        // alert('unsubscribe ' + remove.value)
        Materialize.toast('unsubscribe ' + remove.value)

        var xhr = new XMLHttpRequest()
        xhr.open("POST", '/unsub', true)
        xhr.setRequestHeader('Content-Type', 'application/json')
        xhr.send(JSON.stringify({
          data : remove.value
        }))
        remove.value = ''
      }
      return false
    }
    </script>
  <style>
    html {
      height:100%;
    }
    body {
      font-family: 'Cabin Sketch', cursive;
      min-height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
    }bold

    h1 {
      text-align:center;
    }

    a {
      outline: none;
      text-decoration: none;
      padding: 2px 1px 0;
    }

    a:link {
      color: #265301;
    }

    a:visited {
      color: #437A16;
    }

    a:focus {
      border-bottom: 1px solid;
      background: #BAE498;
    }

    a:hover {
      border-bottom: 1px solid;
      background: #CDFEAA;
    }

    a:active {
      background: #265301;
      color: #CDFEAA;
    }

    .toast {
      font-size:200%;
    }
  </style>

  </body>
</html>
